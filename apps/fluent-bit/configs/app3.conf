[SERVICE]
    Flush        1
    Log_Level    info
    Parsers_File /fluent-bit/etc/parsers.conf
    storage.path /fluent-bit/storage

[INPUT]
    Name              tail
    Path              /simulator/logs/app.log
    Parser            custom_log
    Tag               app3.log
    DB                /fluent-bit/storage/flb.db
    Refresh_Interval  1
    Skip_Long_Lines   On

[FILTER]
    Name    modify
    Match   app3.log
    Add     application_name app3
    Add     environment development
    Rename  level    log_level
    Rename  message  log_message
    Rename  traceid  trace_id

[FILTER]
    Name    record_modifier
    Match   app3.log
    Record  source_application app3
    Record  fluent_bit_instance app3

[OUTPUT]
    Name  http
    Match *
    Host  ${PRODUCER_HOST}
    Port  ${PRODUCER_PORT}
    URI   /ingest
    Format json
    Json_date_key timestamp
    Json_date_format iso8601
    Retry_Limit 1000
